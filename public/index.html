<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<title>Battle Tanks</title>
		<link rel="stylesheet" href="/css/style.css">
		<script type="text/javascript" src="//code.jquery.com/jquery-2.1.1.min.js"></script>
		<script type="text/javascript" src="/socket.io/socket.io.js"></script>
		<script type="text/javascript" src="js/canvas_tank.js"></script>
		<script type="text/javascript" src="js/bullet.js"></script>
		<script type="text/javascript" src="js/tank.js"></script>
		<!-- <script type="text/javascript" src="js/game.js"></script> -->

		<script>
			$(function() {

			socket = io.connect();

		 $(function() {
			$('body').mousemove(function(event) {
				if (myTank.nickname !== 'undefined') myTank.moveTurret(event.pageX,event.pageY);
					// console.log('mouseX: ' + event.pageX);
					// console.log('mouseY: ' + event.pageY);
				});
				
			// Make lobby appear
			$('#splashbutton').on('click', connectToLobby);

			$('body').on('keydown', function(event) {
				if (event.keyCode === 66) {
					console.log(myTank.getCorners());
				}
			});

				socket.on('canvasUpdate', receiveUpdate);

				$('body').on('click', '#p1', function() {
					$('#p1').remove();
					$('#p2').remove();
					startGame('p', 'red', 'q', 'blue');
				});
				$('body').on('click', '#p2', function() {
					$('#p1').remove();
					$('#p2').remove();
					startGame('q', 'blue','p', 'red');
				});
			});

			// Establishes socket connection and loads chat lobby
			function connectToLobby() {
				// AJAX request for socket.js to open a socket connection
				// $.get('/socket').done(function(data) {
				var scriptElement = document.createElement('script');
				scriptElement.src = '/js/socket.js';
				$('#splashpage').hide();	
				$('#lobby').show();
				$('#loginpage').show();
				$('body').append(scriptElement);
				loadChatroom();
				// });
			}

			function loadChatroom() {	
				// AJAX request for chatroom.js
				var scriptElem = document.createElement('script');
				scriptElem.src = '/js/chatroom.js';
				document.body.appendChild(scriptElem);
				// $.get('/chatroom').done(function(data) {
				// });
			}

		</script>

	</head>

	<body>
		<canvas id='canvas' height=600 width=1000></canvas>
		
		<div id="splashpage">
			<h1>Battle Tanks</h1>
			<button id="splashbutton">Go to battle</button>	
		</div>

		<div id="lobby">
			<div class="chatcontainer">
				<div class="userscontainer">
					
				</div>
				<div class="chatmessagescontainer">
					
				</div>
			</div>
			<div class="textinputcontainer">
				<input type="text" id="messageinput" placeholder="Type your message here">
				<input class="sendbutton" type="button" value="Send"/>
			</div>
		</div>

		<div id="loginpage">
			<div class="loginform">
				<input type="text" type="submit" id="login-input" placeholder="Select your username">
			</div>
		</div>

	</body>


</html>
